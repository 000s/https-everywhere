<!--
	For other Yandex coverage, see Yandex.xml.


	Problematic subdomains:

		- img.encyc *

	* Mismatched, CN: yastatic.net


	Fully covered subdomains:

		- (www.)?	(www → ^)

		- ((www.)?[^.]+|[^.]+.[^.]+): *	(www → ^)

			- avatars
			- \d+.avatars
			- a.captcha
			- cache-default04e.cdn
			- cache-default05h.cdn
			- cache-default06f.cdn
			- download.cdn
			- \d.cs-ellpic
			- disk
			- favicon
			- img-css.friends
			- img
			- img-fotki
			- img\d-fotki
			- img
			- img5-fotki
			- st.kp
			- mdata
			- money
			- resize
			- lego.static
			- translate
			- wi

	* Except where excluded below

-->
<ruleset name="Yandex.net (partial)">

	<target host="yandex.net" />
	<target host="*.yandex.net" />
		<!--
			Data clusters for Maps and Video:
								-->
		<exclusion pattern="^http://(?:jgo|vec\d+|stv\d+)\.maps\.yandex\.net/" />
		<exclusion pattern="^http://[^.]+-tub(?:-[^.]+)?\.yandex\.net/" />
		<!--
			Search suggestions:
						-->
		<exclusion pattern="^http://suggest-[a-z]+\.yandex\.net/" />
		<!--
			Needed for Yandex video player to work:
								-->
		<exclusion pattern="^http://[^.]+\.video\.yandex\.net/" />


	<rule from="^http://(?:www\.)?([^.]+)\.yandex\.net/"
		to="https://$1.yandex.net/" />

	<rule from="^http://(?:www\.)?yandex\.net/"
		to="https://yandex.net/" />

	<!--	Here we can enable 4+ level domains with a single regexp,
		but I've never seen any domains more that 4 levels deep
		in Yandex network, so I wouldn't enable them now -
		it may be unconvenient and may broke some services.
		Only 4-level domains match.
						-->
	<rule from="^http://([^.]+)\.([^.]+)\.yandex\.net/"
		to="https://$1.$2.yandex.net/" />


	<!--	Timeout

		Example: https://market.yandex.ru/search.xml?text=draytek&hid=91083&srnum=233
		List: https://mail1.eff.org/pipermail/https-everywhere-rules/2012-April/001094.html
				-->
	<rule from="^https://cs-ellpic\.yandex\.net/"
		to="http://cs-ellpic.yandex.net/" downgrade="1" />

</ruleset>
