<!--
	For other Google coverage, see GoogleServices.xml

	Problematic domains:

		- www.goo.gl		(404; mismatched, CN: *.google.com)
		- *-opensocial.googleusercontent.com ***

	*** Breaks followers widget - https://trac.torproject.org/projects/tor/ticket/7294
-->
<ruleset name="Google Services">
	<target host="*.ggpht.com" />
	<target host="goo.gl" />
	<target host="www.goo.gl" />
		<exclusion pattern="^http://cbks0\.google\.com/(?:$|\?)" />
			<test url="http://cbks0.google.com/" />
			<test url="http://cbks0.google.com/?" />
			<test url="http://cbks0.google.com/?foo" />
		<exclusion pattern="^http://gg\.google\.com/(?!csi(?:$|\?))" />
			<test url="http://gg.google.com/" />
			<test url="http://gg.google.com/foo" />
			<test url="http://gg.google.com/foo?" />
			<test url="http://gg.google.com/foo?bar" />
	<target host="googlecode.com" />
	<target host="*.googlecode.com" />
	<target host="googlesource.com" />
	<target host="*.googlesource.com" />
	<target host="*.googlesyndication.com" />
	<target host="*.googleusercontent.com" />
		<target host="*.corp.googleusercontent.com" />
		<!--
			Necessary for the Followers widget:

				 https://trac.torproject.org/projects/tor/ticket/7294
											-->
		<exclusion pattern="http://[^@:\./]+-opensocial\.googleusercontent\.com" />
			<test url="http://foo-opensocial.googleusercontent.com" />
			<test url="http://bar-opensocial.googleusercontent.com" />
			<test url="http://foobar-opensocial.googleusercontent.com" />

	<securecookie host="^mail-attachment\.googleusercontent\.com$" name=".+" />

	<!--    - lh 3-6 exist
		- All appear identical
		- Identical to lh\d.googleusercontent.com
					-->
	<rule from="^http://lh(\d)\.ggpht\.com/"
		to="https://lh$1.ggpht.com/" />
		<test url="http://lh3.ggpht.com/" />
		<test url="http://lh4.ggpht.com/" />
		<test url="http://lh5.ggpht.com/" />
		<test url="http://lh6.ggpht.com/" />

	<rule from="^http://(www\.)?goo\.gl/"
		to="https://goo.gl/" />
		<test url="http://www.goo.gl/" />
		<test url="http://goo.gl/" />

	<!-- wildcards -->

	<rule from="^http://([^@:\./]+)\.googleusercontent\.com/"
		to="https://$1.googleusercontent.com/" />
		<test url="http://webcache.googleusercontent.com/" />
		<test url="http://foo.googleusercontent.com/" />
		<test url="http://bar.googleusercontent.com/" />

	<rule from="^http://([^/:@\.]+\.)?googlecode\.com/"
		 to="https://$1googlecode.com/" />
		<test url="http://foo.googlecode.com/" />
		<test url="http://bar.googlecode.com/" />
		<test url="http://www.googlecode.com/" />

	<rule from="^http://([^@:\./]+\.)?googlesource\.com/"
		to="https://$1googlesource.com/" />
		<test url="http://foo.googlesource.com/" />
		<test url="http://bar.googlesource.com/" />
		<test url="http://www.googlesource.com/" />
</ruleset>
