<!--
	CDN buckets:

		- s3.amazonaws.com/zd-assets/ | d16cvnquvjw7pr.cloudfront.net


	Clients with custom domains redirect back to said domains when rewritten
	to their respective zendesk.com subdomains. All resources on client
	pages are fetched from assets.zendesk.com, save for:

		- favicon.ico
		- generated/
		- system/.+/favicon.ico
		- widgets/


	Problematic domains:

		- cdn.zendesk.com *

	* Mismatched


	Fully covered domains:

		- p6assets.zendesk.com

		- p[1-6].zdassets.com:


	Mixed content:

		- Images, on:

			- www from s3.amazonaws.com
			- www from d26a57ydsghvgx.cloudfront.net

-->
<ruleset name="Zendesk (partial)">

	<target host="p1.zdassets.com" />
	<target host="p2.zdassets.com" />
	<target host="p3.zdassets.com" />
	<target host="p4.zdassets.com" />
	<target host="p5.zdassets.com" />
	<target host="p6.zdassets.com" />
	<target host="zendesk.com" />
	<target host="*.zendesk.com" />

		<exclusion pattern="^http://video\.zendesk\.com/" />

			<test url="http://video.zendesk.com/" />

		<!--	Direct rewrites:
					-->
		<test url="http://p1.zdassets.com/images/composite.gif" />
		<test url="http://p2.zdassets.com/images/composite.gif" />
		<test url="http://p3.zdassets.com/images/composite.gif" />
		<test url="http://p4.zdassets.com/images/composite.gif" />
		<test url="http://p5.zdassets.com/images/composite.gif" />
		<test url="http://p6.zdassets.com/images/composite.gif" />

		<test url="http://developer.zendesk.com/" />
		<test url="http://support.zendesk.com/" />
		<test url="http://www.zendesk.com/" />

		<!--	Special cases:
					-->
		<test url="http://cdn.zendesk.com/" />


	<!--	Not secured by server:
					-->
	<!--securecookie host="^p[1-6]\.zdassets\.com$" name="^(_zendesk_shared_session|_zendesk_session)$" /-->
	<!--securecookie host="^\.zendesk\.com$" name="^(__cfduid|__qca|cf_clearance)$" /-->
	<!--securecookie host="^p6assets\.zendesk\.com$" name="^(_zendesk_session|_zendesk_shared_session)$" /-->

	<!--securecookie host="^(.*\.)?zendesk\.com$" name=".+" /-->

	<securecookie host="^p\d\.zdassets\.com$" name=".+" />
	<securecookie host="^\.zendesk\.com$" name="^(?:__cfduid|__qca|cf_clearance)$" />
	<securecookie host="^p\dassets\.zendesk\.com$" name=".+" />


	<rule from="^http://cdn\.zendesk\.com/"
		to="https://d16cvnquvjw7pr.cloudfront.net/" />

	<rule from="^http:"
		to="https:" />

</ruleset>
