<!--
	Other Twitter rulesets:

		- Twitter_Community.com.xml


	Nonfunctional domains:

		- status.twitter.com *
		- status.twitter.jp *

	* Tumblr


	CDN buckets:

		- twimg0-0.akamaihd.net

		- a1095.g.akamai.net/=/1095/134446/1d/platform.twitter.com/ | platform2.twitter.com.edgesuite.net

			- platform2.twitter.com

		- twitter-any.s3.amazonaws.com
		- twitter-blog.s3.amazonaws.com

		- d2rdfnizen5apl.cloudfront.net

			- s.twimg.com

		- ssl2.twitter.com.edgekey.net
		- twitter.github.com


	Problematic domains:

		- twimg.com subdomains:

			- s		(cloudfront)

		- twitter.com subdomains:

			- platform[0-3]		(403, akamai)


	Fully covered domains:

		- (www.)t.co		(www → ^)

		- twimg.com subdomains:

			- a\d
			- abs
			- amp
			- dnt
			- ea
			- g
			- g2
			- gu
			- hca
			- jp
			- ma
			- ma[0123]
			- o
			- p
			- pbs
			- r
			- s		(→ d2rdfnizen5apl.cloudfront.net)
			- si[0-5]
			- syndication
			- cdn.syndication
			- tailfeather
			- ton
			- v
			- widgets

		- twitter.com subdomains:

			- (www.)
			- 201[0-4]
			- about
			- ads
			- analytics
			- api
			- cdn.api
			- urls.api
			- apps
			- blog
			- business
			- preview.cdn
			- preview-dev.cdn
			- preview-stage.cdn
			- de
			- dev
			- en
			- engineering
			- es
			- firefox
			- fr
			- it
			- ja
			- jp
			- m
			- media
			- mobile
			- music
			- oauth
			- p
			- pic
			- platform
			- platform[0-3]		(→ platform)
			- widgets.platform
			- search
			- static
			- support
			- transparency
			- upload


	These altnames don't exist:

		- i3.twimg.com
		- p-dev.twimg.com
		- vmtc.twimg.com

		- cdn-dev.api.twitter.com


	Insecure cookies are set for these domains:

		- .t.co
		- twitter.com
		- .twitter.com
		- mobile.twitter.com

-->
<ruleset name="Twitter">

	<!--	Direct rewrites:
					-->
	<target host="t.co" />

	<target host="a0.twimg.com" />
	<target host="a1.twimg.com" />
	<target host="a2.twimg.com" />
	<target host="a3.twimg.com" />
	<target host="a4.twimg.com" />
	<target host="a5.twimg.com" />
	<target host="a6.twimg.com" />
	<target host="a7.twimg.com" />
	<target host="a8.twimg.com" />
	<target host="a9.twimg.com" />
	<target host="abs.twimg.com" />
	<target host="amp.twimg.com" />
	<target host="dnt.twimg.com" />
	<target host="ea.twimg.com" />
	<target host="g.twimg.com" />
	<target host="g2.twimg.com" />
	<target host="gu.twimg.com" />
	<target host="hca.twimg.com" />
	<target host="jp.twimg.com" />
	<target host="ma.twimg.com" />
	<target host="ma0.twimg.com" />
	<target host="ma1.twimg.com" />
	<target host="ma2.twimg.com" />
	<target host="ma3.twimg.com" />
	<target host="o.twimg.com" />
	<target host="p.twimg.com" />
	<target host="pbs.twimg.com" />
	<target host="r.twimg.com" />
	<target host="si0.twimg.com" />
	<target host="si1.twimg.com" />
	<target host="si2.twimg.com" />
	<target host="si3.twimg.com" />
	<target host="si4.twimg.com" />
	<target host="si5.twimg.com" />
	<target host="syndication.twimg.com" />
	<target host="cdn.syndication.twimg.com" />
	<target host="tailfeather.twimg.com" />
	<target host="ton.twimg.com" />
	<target host="v.twimg.com" />
	<target host="widgets.twimg.com" />

	<target host="twitter.com" />
	<target host="2010.twitter.com" />
	<target host="2011.twitter.com" />
	<target host="2012.twitter.com" />
	<target host="2013.twitter.com" />
	<target host="2014.twitter.com" />
	<target host="about.twitter.com" />
	<target host="ads.twitter.com" />
	<target host="analytics.twitter.com" />
	<target host="apps.twitter.com" />
	<target host="blog.twitter.com" />
	<target host="api.twitter.com" />
	<target host="cdn.api.twitter.com" />
	<target host="urls.api.twitter.com" />
	<target host="business.twitter.com" />
	<target host="preview.cdn.twitter.com" />
	<target host="preview-dev.cdn.twitter.com" />
	<target host="preview-stage.cdn.twitter.com" />
	<target host="de.twitter.com" />
	<target host="dev.twitter.com" />
	<target host="engineering.twitter.com" />
	<target host="en.twitter.com" />
	<target host="es.twitter.com" />
	<target host="firefox.twitter.com" />
	<target host="fr.twitter.com" />
	<target host="it.twitter.com" />
	<target host="ja.twitter.com" />
	<target host="jp.twitter.com" />
	<target host="m.twitter.com" />
	<target host="media.twitter.com" />
	<target host="mobile.twitter.com" />
	<target host="music.twitter.com" />
	<target host="oauth.twitter.com" />
	<target host="p.twitter.com" />
	<target host="pic.twitter.com" />
	<target host="platform.twitter.com" />
	<target host="widgets.platform.twitter.com" />
	<target host="search.twitter.com" />
	<target host="static.twitter.com" />
	<target host="support.twitter.com" />
	<target host="transparency.twitter.com" />
	<target host="upload.twitter.com" />
	<target host="www.twitter.com" />

	<!--	Special cases:
				-->
	<target host="www.t.co" />

	<target host="s.twimg.com" />

	<target host="platform0.twitter.com" />
	<target host="platform1.twitter.com" />
	<target host="platform2.twitter.com" />
	<target host="platform3.twitter.com" />


	<!--	Not secured by server:
					-->
	<!--securecookie host="^\.t\.co$" name="^muc$" /-->
	<!--securecookie host="^twitter\.com$" name="^external_referer$" /-->
	<!--securecookie host="^\.twitter\.com$" name="^(_twitter_sess|guest_id)$" /-->
	<!--securecookie host="^mobile\.twitter\.com$" name="^(req_country|req_country_code|req_ip)$" /-->

	<securecookie host="^\.t\.co$" name=".+" />
	<securecookie host="^(?:.*\.)?twitter\.com$" name=".+" />


	<rule from="^http://(?:www\.)?t\.co/"
		to="https://t.co/" />

	<rule from="^http://s\.twimg\.com/"
		to="https://d2rdfnizen5apl.cloudfront.net/" />

	<rule from="^http://platform\d\.twitter\.com/"
		to="https://platform.twitter.com/" />

	<rule from="^http:"
		to="https:" />

</ruleset>
