<!--
	Other Mozilla rulesets:

		- Allizom.org.xml
		- BrowserID.xml
		- Bugzilla.xml
		- Firefox.com.xml
		- GetPersonas.xml
		- Lizard_Wrangler.com.xml
		- Mozilla.com.tw.xml
		- Mozilla_Persona.xml
		- Mozilla_Webmaker.xml
		- Open_Badges.xml
		- Public_Suffix.org.xml


	CDN buckets:

		- 2-01-2967-0005.cdx.cedexis.net

			- cdn.mozilla.net

		- wac.1237.edgecastcdn.net/??1237/

			- getpersonas-cdn.mozilla.net
			- hardhat.mozilla.net

		- images.s4.exacttarget.com.edgesuite.net

			- image.e.mozilla.org

		- click.virt.s4.exacttarget.com

			- click.e.mozilla.org

		- view.virt.s4.exacttarget.com

			- view.e.mozilla.org


	Nonfunctional domains:

		- www.authstage.mozilla.com ³
		- identity.mozilla.com ¹
		- www-trunk.stage.mozilla.com ³

		- mozilla.org subdomains:

			- bonsai ²
			- browserquest ²
			- dxr ²
			- view.e ³
			- graphs ²
			- krakenbenchmark ²
			- releases ²
			- sfx-images ²		(banners)
			- start ³
			- website-archive ²
			- www-archive ²

		- blog.webfwd.org ³

	¹ Hosted on tumblr
	² Refused
	³ Dropped


	Problematic domains:

		- labs.mozilla.com ¹
		- cdn.mozilla.net		(404; mismatched, CN: gp1.wac.edgecastcdn.net)
		- download.cdn.mozilla.net	(404; mismatched, CN: gp1.wac.edgecastcdn.net)
		- getpersonas-cdn.mozilla.net	(404; mismatched, CN: gp1.wac.edgecastcdn.net)
		- hardhat.mozilla.net ⁵
		- www.mozilla.net *

		- mozilla.org subdomains:

			- affiliates-cdn	(works; mismatched, CN: affiliates.mozilla.org)
			- click.e		(works; mismatched, CN: *.virt.s4.exacttarget.com)
			- image.e		(works, akamai)
			- labs ¹
			- talkback-public *

		- hardhat.mozilla.net ⁵

	¹ Refused
	⁵ Works; mismatched, CN: gp1.wac.edgecastcdn.net
	* Prompts for LDAP login; mismatched, CN: static-san.mozilla.org


	Fully covered domains:

		- drumbeat.org
		- www.drumbeat.org

		- mozilla.com subdomains:

			- (www.)
			- activations
			- addons
			- air
			- basket
			- blog
			- brasstacks
			- careers
			- crash-analysis
			- crash-stats
			- data
			- fhr.data
			- input
			- labs		(→ mozillalabs.com)
			- mail
			- people
			- mail.corp.phx1

			- services subdomains:

				- ^
				- account
				- auth
				- location
				- setup

			- snippets
			- support

		- mozilla.net subdomains:

			- static-cdn.addons
			- static-ssl-cdn.addons

			- cdn subdomains:

				- activations
				- addons
				- developer
				- download		(→ ftp.mozilla.org)
				- download-installer
				- fhr
				- getpersonas
				- marketplace
				- mozorg
				- support
				- versioncheck

			- getpersonas-cdn	(→ getpersonas.cdn)
			- videos-cdn
			- www			(→ www.mozilla.org)

		- mozilla.org subdomains:

			- (www.)

			- activations

			- addons subdomains:

				- ^
				- forums
				- pyrepo
				- services

			- affiliates
			- affiliates-cdn	(→ affiliates)
			- air
			- aus3
			- aus4
			- basket
			- beta
			- blog
			- boardwiki
			- bugzilla
			- bzr
			- calendar
			- careers
			- communitystore
			- creative
			- developer
			- directory
			- dnt
			- donate
			- download
			- dragnet
			- education
			- etherpad
			- fb-affiliates
			- firefoxflicks
			- firefoxlive
			- forums
			- foundationwiki
			- ftp
			- gameon
			- gpg
			- hacks
			- hg
			- inform
			- input
			- intlstore
			- intranet
			- join
                        - keys
                        - keyserver
			- l10n
			- labs		(→ mozillalabs.com)
			- ldap
			- lists
			- localize
			- m
			- svc.m
			- mail
			- mana
			- marketplace
			- metrics
			- moztrap
			- mpl
			- mxr
			- nightly
			- outgoing
			- people
			- pfs
			- planet
			- quality
			- reps
			- securitywiki
			- sendto
			- studentreps
			- support
			- talkback-public	(→ crash-stats.mozilla.com)
			- telemetry
			- tbpl

			- telemetry
			- fxos.telemetry
			- hotfix.telemetry
			- incoming.telemetry
			- loop.telemetry

			- telemetry-dash
			- videos
			- wiki

		- mdn.mozillademos.org
		- (www.)mozillaignite.org
		- blog.mozillaignite.org

		- mozillalabs.com subdomains:

			- (www.)
			- apps
			- bespin
			- bespinplugins
			- gaming
			- heatmap
			- jetpack
			- testpilot
			- webmaker

		- planet.mozillamessaging.com
		- support.mozillamessaging.com
		- (www.)webfwd.org


	These altnames don't exist:

		- generic-san.mozilla.org
		- analysis.telemetry.mozilla.org


	Cookie domains:

		- mail.mozilla.com
		- mail.corp.phx1.mozilla.com
		- addons.mozilla.org
		- reps.mozilla.org


	Mixed content:

		- Images, on:

			- hardhat.cdn.mozilla.net from www.mozilla.org *
			- blog.mozilla.org from $self *
			- www.mozilla.org from www.seamonkey-project.org

		- Ad on activations.cdn.mozilla.net from getpocket.com *

	* Secured by us

-->
<ruleset name="Mozilla">

	<target host="drumbeat.org" />
	<target host="www.drumbeat.org" />
	<target host="mozilla.com" />
	<target host="*.mozilla.com" />
		<exclusion pattern="^http://(?:www\.authstage|fxfeeds|identity|www-trunk\.stage)\.mozilla\.com/" />
	<target host="*.mozilla.net" />
		<exclusion pattern="^http://(?:cdn|hardhat)\.mozilla\.net/" />
	<target host="mozilla.org" />
	<target host="*.mozilla.org" />
		<!--
			https://mail1.eff.org/pipermail/https-everywhere-rules/2013-July/001649.html
													-->
		<exclusion pattern="^http://(?:bonsai|browserquest|trychooser\.pub\.build|dxr|graphs|krakenbenchmark|releases|sfx-images|start|w(?:ebsite|ww)-archive)\.mozilla\.org/" />

		<!--
			Breaks newsletter:

				https://mail1.eff.org/pipermail/https-everywhere-rules/2013-June/001635.html
									-->
		<exclusion pattern="^http://\w+\.e\.mozilla\.org/" />
	<target host="mdn.mozillademos.org" />
	<target host="mozillaignite.com" />
	<target host="*.mozillaignite.com" />
	<target host="mozillalabs.com" />
	<target host="*.mozillalabs.com" />
	<target host="*.mozillamessaging.com" />
	<target host="webfwd.org" />
	<target host="www.webfwd.org" />


	<!--	Not secured by server:
					-->
	<!--securecookie host="^addons\.mozilla\.org$" name="^(apps/files/tabstops|multidb_pin_writes|recently-viewed-collections|search-appver|search-platform|visitor-seen_impala_first_visit)$" /-->
	<!--securecookie host="^bugzilla\.mozilla\.org$" name="^(BUGLIST|LASTORDER)$" /-->
	<!--securecookie host="^support\.mozilla\.org$" name="^dwf_surveygizmo$" /-->
	<!--securecookie host="^telemetry-dash\.mozilla\.org$" name="^session$" /-->


	<securecookie host="^.*\.mozilla\.(?:com|org)$" name=".+" />
	<securecookie host="^mozilla(?:ignite|labs)\.com$" name=".+" />


	<rule from="^http://(www\.)?(drumbeat|webfwd)\.org/"
		to="https://$1$2.org/" />

	<rule from="^http://labs\.mozilla\.(?:com|org)/+"
		to="https://mozillalabs.com/" />

	<rule from="^http://([\w.-]+\.)?mozilla\.com/"
		to="https://$1mozilla.com/" />

	<!--	Redirects as so over http.
						-->
	<rule from="^https?://www\.mozilla\.net/"
		to="https://www.mozilla.org/" />

	<rule from="^https?://download\.cdn\.mozilla\.net/"
		to="https://ftp.mozilla.org/" />

	<rule from="^https?://getpersonas-cdn\.mozilla\.net/"
		to="https://getpersonas.cdn.mozilla.net/" />

	<rule from="^http://([\w\.-]+)\.mozilla\.net/"
		to="https://$1.mozilla.net/" />

	<rule from="^https?://affiliates-cdn\.mozilla\.org/"
		to="https://affiliates.mozilla.org/" />

	<!--	Would these rules be safe?

	<rule from="^http://click\.e\.mozilla\.org/"
		to="https://click.virt.s4.exacttarget.com/" />

	<rule from="^http://image\.e\.mozilla\.org/"
		to="https://image.s4.exacttarget.com/" /-->

	<!--	Redirects like so over http.
						-->
	<rule from="^https?://talkback-public\.mozilla\.org/"
		to="https://crash-stats.mozilla.com/" />

	<rule from="^http://([\w\.-]+\.)?mozilla\.org/"
		to="https://$1mozilla.org/" />

	<rule from="^http://mdn\.mozillademos\.org/"
		to="https://mdn.mozillademos.org/" />

	<rule from="^http://(\w+\.)?mozillaignite\.com/"
		to="https://$1mozillaignite.com/" />

	<rule from="^http://(www\.)?mozillalabs\.com/"
		to="https://$1mozillalabs.com/" />

	<rule from="^http://(\w+)\.mozillalabs\.com/"
		to="https://$1.mozillalabs.com/"/>

	<rule from="^http://(planet|support)\.mozillamessaging\.com/"
		to="https://$1.mozillamessaging.com/" />

</ruleset>
