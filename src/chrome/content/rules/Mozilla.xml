<!--
	BOOOO: Firefox.com (which some download links pass through)
	is in HTTP only...


	Nonfunctional:

		- static.mozilla.org		(cert valid; shows www data)
		- sfx-images.mozilla.org	(banners)

-->
<ruleset name="Mozilla">

	<target host="drumbeat.org" />
	<target host="www.drumbeat.org" />
	<target host="mozilla.com" />
	<target host="*.mozilla.com" />
	<target host="mozilla.net" />
	<target host="static-ssl-cdn.addons.mozilla.net" />
	<target host="www.mozilla.net" />
	<target host="mozilla.org" />
	<target host="*.mozilla.org" />
		<exclusion pattern="^http://nightly\.mozilla\.org/" />
	<!--	* for cross-domain cookie.	-->
	<target host="*.developer.mozilla.org" />
	<target host="mozillalabs.com" />
	<target host="*.mozillalabs.com" />
	<target host="mozillamessaging.com" />
	<target host="*.mozillamessaging.com" />


	<securecookie host="^.*\.mozilla\.(com|org)$" name=".*" />


	<rule from="^http://(?:www\.)?drumbeat\.org/"
		to="https://www.drumbeat.org/" />

	<rule from="^http://((?:blog|crash-stats|input|people|support|www)\.)?mozilla\.com/"
		to="https://$1mozilla.com/" />

	<!--	Redirects as so over http.	-->
	<rule from="^https?://(?:www\.)?mozilla\.net/"
		to="https://www.mozilla.org/" />

	<rule from="^http://static-ssl-cdn\.addons\.mozilla\.net/"
		to="https://static-ssl-cdn.addons.mozilla.net/" />

	<!--	Cert doesn't match affiliates-cdn	-->
	<rule from="^http://(?:(affiliates)(?:-cdn)?|(addons|blog|bzr|communitystore|creative|developer|directory|donate|education|etherpad|firefoxlive|ftp|intlstore|krakenbenchmark|l10n|lists|localize|hacks|hg|labs|mail|mpl|mxr|nightly|studentreps|support|tbpl|quality|wiki|www)(\.))?mozilla\.org/"
		to="https://$1$2$3mozilla.org/" />

	<rule from="^http://(?:www\.)?mozillalabs\.com/"
		to="https://mozillalabs.com/" />

	<rule from="^http://(apps|bespin(?:plugins)?|gaming|heatmap|jetpack|testpilot)\.mozillalabs\.com/"
		to="https://$1.mozillalabs.com/"/>

	<rule from="^http://(planet\.|support\.|www\.)?mozillamessaging\.com/"
		to="https://$1mozillamessaging.com/" />

</ruleset>
