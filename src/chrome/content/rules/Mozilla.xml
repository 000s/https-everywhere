<!--
	Other Mozilla rulesets:

		- BrowserID.xml
		- Bugzilla.xml
		- GetPersonas.xml
		- Mozilla_Webmaker.xml


	Nonfunctional domains:

		- identity.mozilla.com		(hosted on Tumblr)
		- static.mozilla.com		(CN: www.mozilla.com; 404)
		- dxr.mozilla.org		(times out)
		- nightly.mozilla.org		(in what way doesn't this work?)
		- planet.mozilla.org		(ditto)
		- releases.mozilla.org
		- sfx-images.mozilla.org	(CN: www.mozilla.com; banners)
		- www-archive.mozilla.org	(CN: www.mozilla.com; 404)
		- blog.webfwd.org		(hosted on Tumblr)


	Problematic domains:

		- (www.)firefox.com		(CN: www.mozilla.com; 404)
		- blog.lizardwrangler.com	(self-signed)
		- download.cdn.mozilla.net	(mismatched, CN: edgecastcdn.net)
		- getpersonas.cdn.mozilla.net	(mismatched, CN: ssl2.cdngc.net)
		- affiliates-cdn.mozilla.org	(CN: affiliates.mozilla.org)
		- beta.mozilla.org		(prompts for LDAP login, CN: www.mozilla.com)
		- krakenbenchmark.mozilla.org	(CN: www.mozilla.org)
		- people.mozilla.org		(CN: people.mozilla.com)
		- talkback-public.mozilla.org	(CN: www.mozilla.org; 404)
		- videos.mozilla.org		(CN: static-cdn.addons.mozilla.net)
		- www.mozillalabs.com		(CN: tbpl.mozilla.org; 403)


	Fully covered domains:

		- drumbeat.org
		- www.drumbeat.org
		- firefox.com
		- marketplace.firefox.com
		- www.firefox.com

		- mozilla.com subdomains:

			- ^
			- blog
			- crash-stats
			- data
			- input
			- people
			- support
			- www

		- mozilla.net subdomains:

			- ^
			- static-cdn.addons
			- static-ssl-cdn.addons
			- addons.cdn
			- download.cdn		(→ ftp.mozilla.org)
			- getpersonas.cdn
			- marketplace.cdn
			- support.cdn
			- getpersonas-cdn	(→ getpersonas.cdn)
			- video-cdn
			- www

		- mozilla.org subdomains:

			- ^
			- forums.addons
			- pyrepo.addons
			- services.addons
			- affiliates
			- affiliates-cdn
			- air
			- beta		(→ mozilla.org/en-US/firefox/channel/)
			- blog
			- bugzilla
			- bzr
			- careers
			- communitystore
			- creative
			- developer
			- directory
			- donate
			- education
			- etherpad
			- firefoxlive
			- forums
			- ftp
			- hacks
			- hg
			- input
			- intlstore
			- l10n
			- lists
			- localize
			- labs
			- mail
			- marketplace
			- mpl
			- mxr
			- nightly
			- outgoing
			- people
			- quality
			- studentreps
			- support
			- talkback-public
			- tbpl
			- videos
			- wiki
			- www

		- mozillaignite.org
		- blog.mozillaignite.org
		- www.mozillaignite.org

		- mozillalabs.com subdomains:

			- ^
			- apps
			- bespin
			- bespinplugins
			- gaming
			- heatmap
			- jetpack
			- testpilot
			- webmaker
			- www

		- planet.mozillamessaging.com
		- support.mozillamessaging.com
		- webfwd.org
		- www.webfwd.org

-->
<ruleset name="Mozilla">

	<target host="drumbeat.org" />
	<target host="www.drumbeat.org" />
	<target host="firefox.com" />
	<target host="*.firefox.com" />
	<target host="mozilla.com" />
	<target host="*.mozilla.com" />
		<exclusion pattern="^http://(?:identity|static)\.mozilla\.com/" />
	<target host="mozilla.net" />
	<target host="*.addons.mozilla.net" />
	<target host="*.cdn.mozilla.net" />
	<target host="*.mozilla.net" />
	<target host="mozilla.org" />
	<target host="*.mozilla.org" />
		<exclusion pattern="^http://(?:dxr|krakenbenchmark|nightly|planet|releases|sfx-images|www-archive)\.mozilla\.org/" />
	<target host="*.addons.mozilla.org" />
	<!--
		*s for cross-domain cookies.
						-->
	<target host="*.developer.mozilla.org" />
	<target host="*.donate.mozilla.org" />
	<target host="*.etherpad.mozilla.org" />
	<target host="*.forums.mozilla.org" />
	<target host="*.wiki.mozilla.org" />
	<target host="mozillaignite.com" />
	<target host="*.mozillaignite.com" />
	<target host="mozillalabs.com" />
	<target host="*.mozillalabs.com" />
	<target host="*.mozillamessaging.com" />
	<target host="webfwd.org" />
	<target host="www.webfwd.org" />


	<securecookie host="^marketplace\.firefox\.com$" name=".+" />
	<securecookie host="^.*\.mozilla\.(?:com|org)$" name=".+" />
	<securecookie host="^mozilla(?:ignite|labs)\.com$" name=".+" />


	<rule from="^http://(www\.)?(drumbeat|webfwd)\.org/"
		to="https://$1$2.org/" />

	<!--	Redirects like so over http.
						-->
	<rule from="^https?://(?:www\.)?firefox\.com/"
		to="https://www.mozilla.org/firefox/" />

	<rule from="^http://marketplace\.firefox\.com/"
		to="https://marketplace.firefox.com/" />

	<rule from="^http://([\w\-]+\.)?mozilla\.com/"
		to="https://$1mozilla.com/" />

	<!--	Redirects as so over http.
						-->
	<rule from="^https?://(?:www\.)?mozilla\.net/"
		to="https://www.mozilla.org/" />

	<rule from="^https?://download\.cdn\.mozilla\.net/"
		to="https://ftp.mozilla.org/" />

	<rule from="^https?://getpersonas-cdn\.mozilla\.net/"
		to="https://getpersonas.cdn.mozilla.net/" />

	<rule from="^http://([\w\-\.]+)\.mozilla\.net/"
		to="https://$1.mozilla.net/" />

	<rule from="^https?://affiliates-cdn\.mozilla\.org/"
		to="https://affiliates.mozilla.org/" />

	<rule from="^https?://beta\.mozilla\.org/"
		to="https://www.mozilla.org/firefox/channel/" />

	<rule from="^https?://people\.mozilla\.org/"
		to="https://people.mozilla.com/" />

	<!--	Redirects like so over http.
						-->
	<rule from="^https?://talkback-public\.mozilla\.org/"
		to="https://crash-stats.mozilla.com/" />

	<rule from="^https?://videos\.mozilla\.org/"
		to="https://videos-cdn.mozilla.net/" />

	<rule from="^http://([\w\-\.]+\.)?mozilla\.org/"
		to="https://$1mozilla.org/" />

	<rule from="^http://(\w+\.)?mozillaignite\.com/"
		to="https://$1mozillaignite.com/" />

	<rule from="^https?://(?:www\.)?mozillalabs\.com/"
		to="https://mozillalabs.com/" />

	<rule from="^http://(\w+)\.mozillalabs\.com/"
		to="https://$1.mozillalabs.com/"/>

	<rule from="^http://(planet|support)\.mozillamessaging\.com/"
		to="https://$1.mozillamessaging.com/" />

</ruleset>
