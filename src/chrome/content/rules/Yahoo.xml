<!--
	Other Yahoo rulesets:

		- Flickr.xml
		- Right-Media.xml
		- Yahoo.net.xml
		- Yahoo_APIs.xml
		- Yahoo_Japan.xml
		- Yimg.com.xml
		- YUI_Library.xml


	CDN buckets:

		- yahoosports.teamfanshop.com


	Nonfunctional domains:

		- yahoo.com subdomains:

			- advertising ¹
			- advertisingcentral ¹

			- answers subdomains:

			- answers ²

				- ar ²
				- fr ³
				- malaysia ³
				- uk ²

			- antispam ¹

			- au ¹
			- auction ¹
			- autos ¹
			- br ²
			- ca ²

			- cn subdomains:

				- ^ ¹
				- help ¹
				- news ¹

			- de ²

			- docs subdomains:

				- ^ ¹
				- ar ¹
				- fr ¹

			- en-maktoob ⁴
			- es ²
			- everything ³
			- fantasysports ¹

			- finance subdomains:

				- ^ ²
				- ca ³
				- chart ¹
				- fr ³
				- ichart ¹
				- streamerapi ¹
				- uk ³

			- fr ²
			- ar.games ¹
			- health ¹
			- hk ³
			- hsrd ¹
			- ichart ¹
			- id ²
			- ie ²
			- in ²
			- it ²
			- kr ¹
			- labs ¹
			- tw.ipeen.lifestyle ¹
			- tw.lifestyle ¹
			- local ³
			- maktoob ⁴
			- maps ³
			- fr.maps ⁷
			- gws2.maps ¹
			- mx ²

			- my subdomains:

				- ar ²
				- au ²
				- br ²
				- ca ²
				- de ²
				- es ²
				- fr ²
				- hk ²
				- ie ¹
				- in ²
				- it ²
				- kr ¹
				- mx ²
				- qc ²
				- sg ²
				- tw ²
				- uk ²

			- news subdomains:

				- cn ¹
				- dk ¹
				- ie ¹
				- kr ¹

			- opi ¹
			- ph ²
			- profile ²
			- qc ²
			- ar.rd ¹
			- research ¹
			- rightmedia			(shows speakers.watersmartinnovations.com; mismatched, CN: *.watersmartinnovations.com)

			- search subdomains:

				- ar ¹
				- ca ¹
				- cn ¹
				- de ¹
				- dk ¹
				- fr ¹
				- id ¹
				- ar.images ¹
				- kr ¹
				- malaysia ¹
				- ar.news ¹
				- fr.news ¹
				- malaysia.news ¹
				- sg ¹
				- tools ¹
				- uk ¹
				- gossip-ss.us ¹
				- fr.video ⁵
				- malaysia.video ⁵

			- searchmarketing ¹
			- sg ²
			- shopping ³
			- es.shopping ¹
			- au.sports ³
			- suggestions ¹
			- tw ¹
			- uk ²
			- vn ²
			- voices ²
			- cn.weather ¹
			- visit.webhosting ⁵
			- count.yisou ¹

		- ypolicyblog.com		(reset)
		- www.ypolicyblog.com

	¹ Refused
	² Redirects to http, valid cert
	³ 404, valid cert
	⁴ Redirects to http; mismatched, CN: www.yahoo.com
	⁵ Dropped
	⁶ Recursive redirect
	⁷ 404; mismatched, CN: *.mail.yahoo.com


	Problematic domains:

		- i.acdn.us ¹
		- cm.npc-morris.overture.com ²
		- cm.npc-nydn.overture.com ²
		- totaltravel.co.uk ³
		- www.totaltravel.co.uk ⁴
		- totaltravel.com ³
		- www.totaltravel.com ⁴

		yahoo.com subdomains:

			- fr-ca.actualites ⁵

			- address subdomains:

				- ca ⁶
				- fr ⁶
				- hk ⁶

			- ar		(mixed css from l.yimg.com)

			- fr.advertising ⁵
			- fr.astrology ⁵
			- uk.astrology ⁵
			- id.berita ⁵
			- fr.cars ⁵
			- uk.cars ⁵
			- fr.cinema ⁵
			- mx.clima ⁵
			- ar.deportes ⁵
			- hk.ent ⁴
			- br.esportes ⁴
			- fr.eurosport ⁴
			- fr.divertissement ⁵
			- dk ⁴
			- feedback ⁴

			- games subdomains:

				- br ⁴
				- de ⁴
				- es ⁴
				- fr ⁴
				- id ⁴

			- ie.groups ⁴
			- info		(mixed css from l.yimg.com)
			- fr.jeux ⁵
			- es.juegos ⁵

			- lifestyle subdomains:

				- ar ⁴
				- br ⁴
				- ca ⁴
				- es ⁴
				- fr ⁴
				- ie ⁴
				- it ⁴

			- external.global.media ⁵
			- fr.messenger ¹
			- fr.meteo ⁵
			- it.meteo ⁵
			- webservices.mobile	(works, self-signed)
			- fr.movies ⁴
			- br.mulher ⁵
			- hk.music ⁴
			- fr.musique ⁵
			- de.nachrichten ⁵

			- news subdomains:

				- ar ⁴
				- br ⁴
				- de ⁴
				- id ⁴
				- it ⁴
				- mx ⁴
				- qc ⁴

			- notepad	(works; mismatched, CN: *.calendar.yahoo.com)
			- it.notizie ⁵
			- fr.pourelles ⁵
			- br.esporteinterativo ⁵
			- id.olahraga ⁵
			- privacy	(works; mismatched, CN: info.yahoo.com)
			- ru ⁴
			- fr.sites ⁵
			- smarttv		(works; mismatched, CN: connectedtv.yahoo.com)
			- de.spiele ⁵
			- sport ⁴

			- sports subdomains:

				- ar ⁴
				- br ⁴
				- de ⁴
				- es ⁴
				- id ⁴
				- in ⁴
				- uk ⁴

			- br.tempo ⁵
			- es.tendencias ⁵
			- ar.tiempo ⁵
			- es.tiempo ⁵
			- ar.toolbar	(works; mismatched, CN: *.data.toolbar.yahoo.com)
			- id.travel ⁴
			- uk.travel
			- ca.tv ⁴
			- fr.voyage	(works; expired 2013-01-08, mismatched, CN: uk.travel.yahoo.com)

			- weather subdomains:

				- ar ⁴
				- au ⁴
				- br ⁴
				- de ⁴
				- es ⁴
				- fr ⁴
				- kr ⁴
				- tw ⁴
				- mx ⁴

			- de.wetter ⁵

		- (www.)yhoo.it ⁴		(bit.ly alias)

	¹ Dropped
	² Works, mismatched, CN: *.ysm.yahoo.com
	³ Works; mismatched, CN: builder.totaltravel.com
	⁴ Refused
	⁵ Works; mismatched, CN: *.mail.yahoo.com
	⁶ Works; mismatched, CN: address.yahoo.com


	Partially covered domains:

		- (www.)totaltravel.com		(→ au.totaltravel.yahoo.com, haven't found images/)

		- yahoo.com subdomains:

			- developer		(homepage redirects to http)
			- kr.groups		($ 404s over http)
			- mail			($ redirects to http)
			- in.sports		(→ cricket, /*(?!$) doesn't redirect)


	Fully covered domains:

		- i.acdn.us			(→ s.yimg.com/ck/)

		- (www.)totaltravel.co.uk	(→ au.totaltravel.yahoo.com)

		- yahoo.com subdomains:

			- (www.)
			- address

			- \w\w.address:	(→ address)

				- ca
				- fr
				- hk

			- \w\w.adserver:

				- au
				- uk
				- us

			- global.adserver
			- beap.adx
			- c5.ah
			- c5a.ah
			- cookex.amp
			- s-cookex.amp

			- analytics subdomains:

				- [aoyz]
				- apac
				- y3

			- \w\w.antispam:

				- ca
				- dk
				- fr
				- in

			- global.ard

			- bc subdomains:

				- clicks.beap
				- csc.beap
				- pn1
				- row
				- us

			- boss
			- calendar

			- \w\w.calendar:

				- ar
				- au
				- br
				- ca
				- de
				- dk
				- es
				- fr
				- hk
				- in
				- it
				- tw
				- uk
				- us

			- celebrity

			- \w\w.celebrity:

				- ca
				- es
				- id
				- in
				- it
				- hk
				- ph
				- tw
				- uk

			- migration.cn
			- connectedtv
			- br.contribuidores
			- contributor
			- uk.contributor
			- cricket
			- dk			(→ www)

			- edit subdomains:

				- ^
				- eu
				- na

			- hk.ent		(→ hk.celebrity)
			- edit.europe
			- java.europe		(→ adgallery.zenfs.com)

			- eurosport subdomains:

				- ^
				- de
				- es
				- fr	(→ fr.sports)
				- it
				- uk

			- feedback		(→ yahoo.uservoice.com)

			- games subdomains:

				- ^
				- au
				- ca
				- id	(→ games)
				- uk

			- geo
			- groups

			- \w\w.groups:

				- ar
				- au
				- br
				- ca
				- de
				- dk
				- es
				- fr
				- hk
				- ie	(→ uk.groups)
				- in
				- it
				- mx
				- ph
				- sg
				- tw
				- uk
				- us

			- asia.groups
			- moderators.groups
			- help
			- secure.help
			- homes
			- legalredirect

			- lifestyle subdomains:

				- ar	(→ ar.mujer)
				- au
				- ca	(→ ca.shine)
				- de
				- hk
				- ie	(→ uk.lifestyle)
				- in
				- it
				- mx	(→ mx.mujer)
				- uk

			- login
			- gh.bouncer.login
			- us.lrd
			- m
			- r.m

			- \w\w.m:

				- ar
				- au
				- br
				- ca
				- cn
				- de
				- es
				- fr
				- hk
				- id
				- ie
				- in
				- it
				- kr
				- ph
				- qc
				- sg
				- mx
				- tw
				- uk
				- us
				- vn

			- *.mail:

				- fr
				- overview
				- ca.overview
				- uk.overview
				- us.overview
				- us-mg6
				- c.c.yom
				- \w+-c.c.yom

			- mlogin
			- mobile
			- fr.mobile
			- movies
			- uk.movies
			- ar.mujer
			- mx.mujer
			- music
			- hk.music	(→ hk.celebrity)

			- *.msg:

				- dps			(→ ycpi-mail-dps)
				- prod2.rest-core
				- prod1.rest-notify
				- ycpi-mail-dps
				- ycpi-mail-preferences
				- ycpi-mail-rest-core
				- ycpi-mail-rest-core2

			- my
			- us.my
			- ucs.netsvs

			- news subdomains:

				- ^
				- ar	(→ ar.noticias)
				- au
				- br	(→ br.noticias)
				- au
				- ca
				- es	(→ es.noticias)
				- fr
				- hk
				- in
				- mx	(→ mx.noticias)
				- ph
				- sg
				- tw
				- uk
				- vn

			- cookiex.ngd

			- noticias subdomains:

				- ar
				- br
				- es
				- mx

			- omg
			- rtb.pclick

			- query subdomains:

				- analytics
				- mailapps
				- media
				- ucs
				- us-locdrop
				- video

			- us.rd
			- ru		(→ www)
			- screen
			- fr.screen

			- search subdomains:

				- ^
				- images

				- \w\w.images:

					- ar
					- au
					- br
					- ca
					- cn	(→ sg)
					- de
					- dk
					- es
					- fi
					- fr
					- hk
					- id
					- in
					- it
					- nl
					- mx
					- no
					- nz
					- ph
					- qc
					- ru
					- se
					- sg
					- tw
					- uk
					- vn

				- malaysia.images
				- movies
				- r
				- shopping
				- video

			- rtb.pclick.secure
			- shine
			- order.smallbusiness
			- rd.software

			- sport		(→ sports)

			- sports subdomains:

				- ^
				- ca
				- de	(→ de.eurosport)
				- es	(→ es.eurosport)
				- fr
				- hk
				- uk	(→ uk.eurosport)

			- data.toolbar
			- au.totaltravel
			- travel
			- uk.travel	(→ uk.lifestyle)

			- tv subdomains:

				- ^
				- au
				- ca	(→ tv)
				- fr
				- uk

			- us
			- qos.video
			- yep.video

			- weather subdomains:

				- ^
				- ca
				- hk
				- in
				- ph
				- sg
				- tw	(→ tw.news)
				- uk
				- us

			- dmros.ysm


	Mixed content:

		- css, on:

			- ar.yahoo.com and info.yahoo.com from l[13]?.yimg.com *
			- ar.toolbar.yahoo.com from yui.yahooapis.com *

		- Ads/web bugs, on:

			- au.games.yahoo.com from secure-us.imrworldwide.com *
			- ar.yahoo.com from b.scorecardresearch.com *
			- ar.yahoo.com, \w\w.celebrity.yahoo.com,  m.yahoo.com, \w\w.m.yahoo.com, and ar.mujer.yahoo.com from csc.beap.bc.yahoo.com *
			- au.news.yahoo.com from au.adserver.yahoo.com *
			- shine.yahoo.com from www.facebook.com *

		- Images, on:

			- ar.yahoo.com, \w\w.celebrity.yahoo.com, cricket.yahoo.com, eurosport.yahoo.com, \w\w.eurosport, games.yahoo.com, info.yahoo.com, m.yahoo.com, us.m.yahoo.com, au.news.yahoo.com, screen.yahoo.com, and ar.toolbar.yahoo.com from l.yimg.com *
			- \w\w.weather.yahoo.com from media.zenfs.com *

	* Secured by us


	Reported to fix bug

		https://trac.torproject.org/projects/tor/ticket/4441


	If you have a Yahoo Mail account, please test this ruleset!

-->
<ruleset name="Yahoo! (partial)">

	<target host="i.acdn.us" />
	<target host="rocketmail.com" />
	<target host="www.rocketmail.com" />
	<target host="totaltravel.co.uk" />
	<target host="www.totaltravel.co.uk" />
	<target host="totaltravel.com" />
	<target host="*.totaltravel.com" />
		<exclusion pattern="^http://(?:www\.)?totaltravel\.com/images/" />
	<target host="yahoo.com" />
	<target host="*.yahoo.com" />
		<exclusion pattern="^http://developer\.yahoo\.com/(?:$|\?)" />
		<!--
			!neo 404s over http.
						-->
		<exclusion pattern="^http://kr\.groups\.yahoo\.com/+(?!neo)" />
		<exclusion pattern="^http://mail\.yahoo\.com/+(?:$|\?)" />
		<!--
			Refused:
					-->
		<!--exclusion pattern="^http://(cn|de|dk|id|ie|it|qc)\.news\.yahoo\.com/" /-->
		<!--
			Some pages redirect to http:
							-->
		<exclusion pattern="^http://smallbusiness\.yahoo\.com/(?!servicecheck\.php)" />
	<target host="*.yahoofs.com" />
	<target host="yhoo.it" />
	<target host="ymail.com" />
	<target host="www.ymail.com" />
	<target host="*.zenfs.com" />


	<!--	Some Yahoo cookies are cross-domain cookies.
		It's a case of figuring out which ones
		aren't needed on unsecurable pages.

			- .yahoo.com
				- AO
				- B
					- Set by y3.analytics.yahoo.com/itr.pl & us.bc.yahoo.com/b

				- BA

					- t=\d{10}

				- CH
					- \w{59}/
				- F

				- HP

					- 0

				- MSC
					- t=\d{10}X
				- PH	(set by hjsal)
				- SSL

				- ucs	(set by ucs.query)

					- bnas=\d

				- V

					- v=\d.\d&cc=0&m=0

				- Y

			- .news.yahoo.com

				- ywadp\d+

					- \d+

			- .uk.yahoo.com

				- epc

					- 1

				- fpc

					- d=(\w+.){7}\w+- -&v=1

				- FPCK

					- \w{50}

				- fpc_s

					- d=(\w+.){7}\w+- -&v=1

				- fpt

					- d=(\w+.){7}\w+- -&v=1

				- fpps

					- _page=%7B%22wsid%22%3A%22\d{10}%22%7D

		Others observed:

			- .search.yahoo.com
				- sSN
					-  \w{63}\.\w{22}\-{2}

		-->
	<securecookie host="^\.yahoo\.com$" name="^(?:AO|B|SSL)$" />
	<securecookie host="^(?:\.analytics|\.mail|movies|news|(?:us-locdrop|video)\.query|images\.search|fr\.images\.search|\.?us|\.www)\.yahoo\.com$" name=".+" />
	<securecookie host="^\.zenfs\.com$" name="^BX$" />

	<!--	Could we secure any of these safely?
							-->
	<securecookie host="^\.my\.yahoo\.com$" name="^(myc|MYTMI|U_mtupes)$" />
	<securecookie host="^\.search\.yahoo\.com$" name="^sSN$" />


	<rule from="^http://i\.acdn\.us/"
		to="https://s.yimg.com/ck/" />

	<rule from="^http://(?:www\.)?(?:rocket|y)mail\.com/"
		to="https://mail.yahoo.com/" />

	<rule from="^http://(?:www\.)?totaltravel\.co(?:m|\.uk)/"
		to="https://au.totaltravel.yahoo.com/" />

	<rule from="^http://builder\.totaltravel\.com/"
		to="https://builder.totaltravel.com/" />

	<!--	All appear identical.
					-->
	<rule from="^http://\w\w\.address\.yahoo\.com/"
		to="https://address.yahoo.com/" />

	<rule from="^http://(?:dk|ru)\.yahoo\.com/"
		to="https://www.yahoo.com/" />

	<rule from="^http://hk\.ent\.yahoo\.com/+"
		to="https://hk.celebrity.yahoo.com/" />

	<rule from="^http://java\.europe\.yahoo\.com/"
		to="https://adgallery.zenfs.com/" />

	<rule from="^http://fr\.eurosport\.yahoo\.com/"
		to="https://fr.sports.yahoo.com/" />

	<rule from="^http://feedback\.yahoo\.com/"
		to="https://yahoo.uservoice.com/" />

	<rule from="^http://id\.games\.yahoo\.com/+"
		to="https://games.yahoo.com/" />

	<!--	Redirect drops path and args:
						-->
	<rule from="^http://ie\.(groups|lifestyle)\.yahoo\.com/.*"
		to="https://uk.$1.yahoo.com/" />

	<rule from="^http://(ar|mx)\.(?:lifestyle|mujer)\.yahoo\.com/"
		to="https://$1.mujer.yahoo.com/" />

	<rule from="^http://ca\.(?:lifestyle|shine)\.yahoo\.com/"
		to="https://ca.shine.yahoo.com/" />

	<!--	This rule must be above the main one:
							-->
	<rule from="^http://dps\.msg\.yahoo\.com/"
		to="https://ycpi-mail-dps.msg.yahoo.com/" />

	<!--	Redirect drops path and args:
						-->
	<rule from="^http://hk\.music\.yahoo\.com/.*"
		to="https://hk.celebrity.yahoo.com/music/" />

	<rule from="^http://(ar|br|es|mx)\.n(?:ew|oticia)s\.yahoo\.com/"
		to="https://$1.news.yahoo.com/" />

	<!--	Cert only matches us.rd,
		all appear equivalent.
					-->
	<rule from="^http://rds?\.yahoo\.com/"
		to="https://us.rd.yahoo.com/" />

	<rule from="^http://sport\.yahoo\.com/+"
		to="https://sports.yahoo.com/" />

	<rule from="^http://(de|es|uk)\.sports\.yahoo\.com/+"
		to="https://$1.eurosport.yahoo.com/" />

	<rule from="^http://in\.sports\.yahoo\.com/+$"
		to="https://cricket.yahoo.com/" />

	<!--	Redirect drops path and args:
						-->
	<rule from="^http://uk\.travel\.yahoo\.com/.*"
		to="https://uk.lifestyle.yahoo.com/travel/" />

	<rule from="^http://ca\.tv\.yahoo\.com/+"
		to="https://tv.yahoo.com/" />

	<!--	Redirect drops path and args:
						-->
	<rule from="^http://hk\.tv\.yahoo\.com/.*"
		to="https://hk.music.yahoo.com/" />

	<!--	Redirect drops path and args:
						-->
	<rule from="^http://tw\.weather\.yahoo\.com/.*"
		to="https://tw.news.yahoo.com/weather-forecast/" />

	<rule from="^http://((?:address|(?:\w\w|global)\.adserver|beap\.adx|c5a?\.ah|(?:s-)?cookex\.amp|(?:[aosz]|apac|y3?)\.analytics|\w\w\.antispam|global\.ard|(?:clicks\.beap|csc\.beap|pn1|row|us)\.bc|boss|(?:\w\w\.)?calendar|(?:\w\w\.)?celebrity|migration\.cn|connectedtv|br\.contribuidores|(?:uk\.)?contributor|developer|(?:eu\.|na\.)?edit|edit\.europe|eurosport|(?:de|es|it|uk)\.eurosport|games|(?:au|ca|uk)\.games|geo|groups|(?:\w\w|asia|moderators)\.groups|help|secure\.help|homes|legalredirect|(?:au|de|hk|in|it|uk)\.lifestyle|(?:gh\.bouncer\.)?login|us\.l?rd|m|r\.m|\w\w\.m|mail|[\w-]+(?:\.c\.yom)?\.mail|mlogin|mobile|fr\.mobile|movies|uk\.movies|[\w.-]+\.msg|music|my|us\.my|ucs\.netsvs|news|(?:au|ca|fr|hk|in|ph|sg|tw|uk)\.news|cookiex\.ngd|omg|rtb\.pclick|(?:analytics|mailapps|media|ucs|us-locdrop|video)\.query|screen|fr\.screen|search|(?:images|\w\w\.images|movies|news|r|shopping|video)\.search|sec|rtb\.pclick\.secure|shine|(?:order\.)?smallbusiness|rd\.software|sports|(?:ca|fr|hk)\.sports|data\.toolbar|au\.totaltravel|travel|tv|(?:ar|au|de|fr|uk)\.tv|us|(?:qos|yep)\.video|weather|(?:ca|hk|in|sg|ph|uk|us)\.weather|www|dmros\.ysm)\.)?yahoo\.com/"
		to="https://$1yahoo.com/" />

	<rule from="^http://([\w-]+)\.yahoofs\.com/"
		to="https://$1.yahoofs.com/" />

	<rule from="^http://yhoo\.it/"
		to="https://bit.ly/" />

	<rule from="^http://(\w+)\.zenfs\.com/"
		to="https://$1.zenfs.com/" />

</ruleset>
