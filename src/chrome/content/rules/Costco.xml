
<!--
Disabled by https-everywhere-checker because:
Fetch error: http://shop.costco.com/ => https://shop.costco.com/: (51, "SSL: no alternative certificate subject name matches target host name 'shop.costco.com'")
Fetch error: http://www2.costco.com/ => https://www2.costco.com/: (56, 'SSL read: error:00000000:lib(0):func(0):reason(0), errno 104')

	Other Costco rulesets:

		- Costco-static.com.xml


	^: mismatched, CN: www2.costco.com


	Nonfunctional hosts in *costco.com:

		- video *

	* Shows another domain


	These altnames don't exist:

		- www.www2.costco.com


	Insecure cookies are set for these hosts:

		- www.costco.com
		- www2.costco.com

-->
<ruleset name="Costco.com (partial)" default_off='failed ruleset test'>

	<!--	Direct rewrites:
				-->
	<target host="customerservice.costco.com" />
	<target host="shop.costco.com" />
	<target host="www.costco.com" />
	<target host="www2.costco.com" />

	<!--	Complications:
				-->
	<target host="costco.com"/>

	<!--	Not secured by server:
					-->
	<!--securecookie host="www\.costco\.com$" name="^(JSESSIONID|WC_PERSISTENT)$" /-->
	<!--securecookie host="www2\.costco\.com$" name="^(Commerce2002_TestPersistentCookie|Commerce2002_TestSessionCookie|CostcoCookieCrumb|CostcoTempBasket_v2)$" /-->

	<securecookie host="^(?:.*\.)?costco\.com$" name=".*"/>

	<rule from="^http://costco\.com/"
		to="https://www.costco.com/"/>

	<!-- The content of content and www are actually not identical. -->
	<!-- <rule from="^http://content\.costco\.com/"
		to="https://www.costco.com/"/> -->

	<rule from="^http:"
		to="https:" />

</ruleset>
