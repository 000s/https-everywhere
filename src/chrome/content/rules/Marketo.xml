<!--
	Other Marketo rulesets:

		- Crowd-Factory.xml
		- Mktoresp.com.xml


	Nonfunctional domains:

		- blog.marketo.com *
		- pages2.marketo.com ²

	* Redirects to http
	² 404


	Problematic domains:

		- marketo.com *
		- (www.)marketo.net *

	* Cert only matches *.marketo.com


	Partially covered domains:

		- developers.marketo.com *

	* blog/ redirects to $


	Fully covered domains:

		- marketo.com subdomains:

			- (www.)	(^ → www)
			- app

			- app-\w+:

				- -[a-q]
				- -ab01
				- -ab[ak]
				- -lon0[23]
				- -sj\d
				- -sj[fghn]

			- b2c-mlm
			- community
			- fr
			- launchpoint
			- micro
			- munchkin	(→ munchkin.marketo.net)

			- na-\w+:

				- -[a-df-q]
				- -ab01
				- -ab[ak]
				- -lon02
				- -sj0\d
				- -sj[fhn]

			- summit
			- support

		- marketo.net subdomains:

			- (www.)	(→ www.marketo.com)
			- app		(→ app-a.marketo.com)
			- munchkin
			- ssl-munchkin


	Insecure cookies are set for these hosts:

		- developers.marketo.com
		- fr.marketo.com
		- launchpoint.marketo.com
		- summit.marketo.com
		- www.marketo.com


	Mixed content:

		- Videos on fr from [\da-f-]+.r\d+.cf\d.rackcdn.com *

		- css on developers from $self

		- Images on developers from $self

		- favicons, on:

			- developers from marketo.com ¹
			- developers from $self
			- developers from ^ ¹

		- Bug on developers from www.googletagmanager.com

	¹ Secured by us


	munchkin sets a "_mkto_trk" wildcard cookie on whichever domain it is
	loaded from.

-->
<ruleset name="Marketo (partial)">

	<target host="marketo.com" />
	<target host="*.marketo.com" />
		<!--
			Redirects to http:
						-->
		<!--exclusion pattern="^http://blog\.marketo\.com/($|\?source=|favicon\.ico|wp-content/)" /-->
		<!--
			Redirects to ...:443 or .../$
							-->
		<!--exclusion pattern="^http://developers\.marketo\.com/blog(?:$|[?/])" /-->
		<!--
			Exceptions:
					-->
		<!--exclusion pattern="^http://developers\.marketo\.com/(?!$|assets/|favicon\.ico|foundationforms/|support/|themes/)" /-->
		<!--
			Avoid broken MCB:
						-->
		<exclusion pattern="^http://developers\.marketo\.com/+(?!assets/|favicon\.ico|foundationforms/|themes/)" />

			<test url="http://developers.marketo.com/" />
			<test url="http://developers.marketo.com/assets/Uploads/dev-blog.png" />

	<target host="marketo.net" />
	<target host="*.marketo.net" />

		<test url="http://app-ab01.marketo.com/" />
		<test url="http://community.marketo.com/" />
		<test url="http://fr.marketo.com/" />
		<test url="http://launchpoint.marketo.com/" />
		<test url="http://na-ab01.marketo.com/" />
		<test url="http://summit.marketo.com/" />
		<test url="http://support.marketo.com/" />
		<test url="http://www.marketo.com/" />


	<!--	Not secured by server:
					-->
	<!--securecookie host="^(fr|launchpoint|summit|support|www)\.marketo\.com$" name="^bIPs$" /-->

	<securecookie host="^(?:.*\.)?marketo\.(?:com|net)$" name=".+" />


	<rule from="^http://(?:www\.)?marketo\.(?:com|net)/"
		to="https://www.marketo.com/" />

	<rule from="^http://pages2\.marketo\.com/(?=css/|images/|js/|rs/)"
		to="https://na-abk.marketo.com/" />

	<rule from="^http://(app(?:-\w+)?|b2c-mlm|community|developers|fr|launchpoint|micro|na-\w+|summit|support)\.marketo\.com/"
		to="https://$1.marketo.com/" />

	<!--	Server redirects as so:
					-->
	<rule from="^http://app\.marketo\.net/"
		to="https://app-a.marketo.com/" />

	<rule from="^http://(ssl-)?munchkin\.marketo\.(?:com|net)/"
		to="https://$1munchkin.marketo.net/" />

</ruleset>
