<!--	!functional:
		- icons.wunderground.com	(Akamai; "An error occurred")
-->
<ruleset name="Weather Underground (partial)">

	<target host="wunderground.com"/>
	<target host="*.wunderground.com"/>
	<!--	Akamai. Doesn't work as-is, haven't found bucket	-->
	<target host="icons.wxug.com"/>
	<target host="icons-ak.wxug.com"/>

	<securecookie host="^(.*\.)wunderground\.com$" name=".*"/>

	<rule from="^http://(www\.)?wunderground\.com/"
		to="https://$1wunderground.com/"/>

	<rule from="^http://icons\.wxug\.com/"
		to="https://wunderground.com/"/>

	<!--	some icons-ak data not on icons nor www. e.g.:
			graphics/
			i/wpbg/		-->
	<rule from="^http://icons-ak\.wxu(?:g|underground)\.com/(css|data|scripts|i/wu?)/"
		to="https://wunderground.com/$1/"/>

	<!--	when fetched via https, radblast.asp sets type to null.  That causes the radar image (WUNIDS_map)
		to claim that the radar is offline and display no map.
		This rule fixes the problem by setting type to N0R when it isn't already set.			-->
	<rule from="^https?://radblast-mi\.wunderground\.com/cgi-bin/radar/WUNIDS_map\?([\w&amp;=\.]+)?type=&amp;"
		to="https://radblast-mi.wunderground.com/cgi-bin/radar/WUNIDS_map?$1type=N0R&amp;"/>

</ruleset>
