<!--
	For problematic rules, see Mellanox-problematic.xml.


	Nonfunctional subdomains:

		- community ¹
		- ir		(cert: *.shareholder.com; "Directory Listing Denied")
		- support ¹

	¹ Refused


	Problematic subdomains:

		- calc		(works; expired 2012-09-16, CN: plesk)


	Partially covered subdomains:

		- calc		(→ www)


	Fully covered subdomains:

		- (www.)	(^ → www)
		- (www.)partners

-->
<ruleset name="Mellanox (partial)">

	<!--	Direct rewrites:
				-->
	<target host="partners.mellanox.com" />
	<target host="www.partners.mellanox.com" />
	<target host="www.mellanox.com" />

	<!--	Complications:
				-->
	<target host="mellanox.com" />
	<target host="calc.mellanox.com" />

		<exclusion pattern="^http://calc\.mellanox\.com/(?!$|\?)" />

			<!--	+ve:
					-->
			<test url="http://calc.mellanox.com//" />
			<test url="http://calc.mellanox.com//?" />
			<test url="http://calc.mellanox.com//?f" />
			<test url="http://calc.mellanox.com//?foo" />

			<!--	-ve:
					-->
			<test url="http://calc.mellanox.com/?" />
			<test url="http://calc.mellanox.com/?f" />
			<test url="http://calc.mellanox.com/?foo" />


	<!--	Not secured by server:
					-->
	<!--securecookie host="^(www\.)?mellanox\.com$" name="^PHPSESSID$" /-->
	<!--securecookie host="^(www\.)?partners\.mellanox\.com$" name="^BIGipServerHTTP_Pool$" /-->

	<securecookie host="^(?:(?:www\.)?partners\.|www\.)?mellanox\.com$" name=".+" />


	<!--	^ redirects to www over http,
		so copy that behavior:
					-->
	<rule from="^http://mellanox\.com/"
		to="https://www.mellanox.com/" />

	<rule from="^http://calc\.mellanox\.com/(?:\?.*)?$"
		to="https://www.mellanox.com/" />

	<rule from="^http:"
		to="https:" />

</ruleset>
