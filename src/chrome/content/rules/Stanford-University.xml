<!--
	For problematic rules, see Stanford-University-problematic.xml.


	Other Stanford University rulesets:

		- Hoover_Institution.xml


	store-0ef21.mybigcommerce


	Nonfunctional subdomains:

		- assu			($ redirects to http; at least some paths 404)
		- bma ²
		- bondholder-information(redirects to http)
		- campusmap		(shows hannahousetours, mismatched, CN: hannahousetours.stanford.edu)
		- campus-map ²
		- cantorcollections **
		- cees ⁵
		- create ⁶
		- edf ⁷
		- elections		("not yet configured")
		- emergency **
		- exploredegrees **
		- facts ³
		- fac-web3 ²
		- fah-web		(cert valid; 302s to http)
		- fairuse
		- folding		(cert valid; 302s to http)
		- humsci **
		- liberationtechnology **
		- lytics **
		- oli ³
		- online ³
		- rph ³
		- babar-hn.slac		(rx_record_too_long)
		- home.slac
		- srp			(reused serial)
		- sse			("not yet configured")
		- sselabs		(cert: assu-web.stanford.edu; "not yet configured")
		- stanford-online	(times out)
		- startx		("not yet configured")
		- store			($ redirects to http; at least some paths 404)
		- theory		(shows Fedora test page, self-signed)
		- transportation ⁹
		- www-sul ᵇ

	² Shows hannahousetours
	** Refused
	³ Redirects to http
	⁵ Shows pangea
	⁶ Dropped
	⁷ Shows cepa
	⁹ Plaintext reply
	ᵇ Shows swp


	Problematic subdomains:

		- ^			(cert only matches *.stanford.edu)
		- askjane		(mismatched, CN: studentaffairs.stanford.edu)
		- arts ³
		- biosciences ⁴
		- brannerlibrary ⁵
		- bgm *
		- cme ⁴
		- computing **
		- dor ⁸
		- email **
		- ess **
		- fingate **
		- gse ⁵
		- healthlibrary ⁴
		- hrg ⁴
		- itmetrics **
		- itwinterclosure **
		- maps *
		- netreg ⁹
		- postdocs ⁴
		- search **
		- security ᵃ
		- slac			(cert only matches www.slac)
		- smysp ⁴
		- soe			(refused)
		- stanfordmedicine ⁴
		- studentservicescenter **
		- thestanfordchallenge	(works, mismatched, CN: ood-web1.stanford.edu)
		- vsc ⁴
		- winkleby ⁴
		- www-cs-students	(mismatched, CN: xenon.stanford.edu)
		- www-ee		(mismatched, CN: ee.stanford.edu)


	³ Mixed css
	⁴ Mismatched, CN: med.stanford.edu
	⁵ 403
	* Works, mismatched, CN: lbre.stanford.edu
	** Redirects to http
	⁸ Mismatched, CN: doresearch.stanford.edu
	⁹ Shows rescomp
	ᵃ Refused


	Partially covered subdomains:

		- plato *
		- soe	(→ engineering, [^/?]+ 404s)
		- stanfordcareers **
		- www-cs-students ²	(→ xenon)
		- xenon ²

	* Some pages redirect to http, others 404
	** Avoiding false/broken MCB
	² Personal dirs 404


	Fully covered subdomains:

		- (www.)		(^ → www)
		- accessories
		- adminguide
		- ai
		- alumni
		- annualreport
		- answers
		- askjane
		- assu-web
		- ccrma
		- crowd
		- crypto
		- (www.)cs	( www → ^)
		- ctr
		- cyberlaw
		- ehsappprd1
		- engineering
		- events
		- fingate
		- founders
		- hannahousetours
		- itservices
		- itunes
		- janestanford
		- (www.)law
		- blogs.law
		- cch.law
		- lbre
		- lists
		- mailman
		- maven
		- med
		- news
		- npl
		- oia
		- openflow
		- osep
		- parents
		- parentsweekend
		- pgnet
		- publicaffairs
		- refunds
		- remedyweb
		- search
		- siepr

		- slac subdomains:

			- (www.)	(^ → www)
			- bbr-wiki
			- news
			- oraweb
			- webauth1
			- www2
			- www6
			- www-conf
			- www-group
			- www-public

		- stanfordevents
		- stanfordwho
		- studentaffairs
		- studentservicescenter
		- ucomm
		- visit
		- waivers
		- web
		- weblogin
		- www-ee		(→ ee)


	Observed cookie domains:

		- . *
		- .answers
		- .cs
		- .engineering
		- .itservices
		- .lbre
		- .oit ²
		- .stanfordcareers **

	* Not secured by us <= accounting for possible use on unsecured domains
	² Secured by server
	** Not secured by us <= incomplete coverage


	Mixed content:

		- iframe on admission from www.youtube.com *

		- css, on:

			- admission from $self
			- admission from www
			- biosciences from $self
			- stanfordcareers from $self *
			- admission, giving, precollegiate, stanfordcareers from fonts.googleapis.com *

		- Images, on:

			- admission from $self
			- (www.)med from med *

		- Bugs, on:

			- events from www.facebook.com *

	* Secured by us

-->
<ruleset name="Stanford University (partial)">

	<target host="stanford.edu" />
	<target host="*.stanford.edu" />
		<exclusion pattern="^http://plato\.stanford\.edu/+(?!css/|symbols/)" />
		<!--
			Avoid false/broken MCB:
						-->
		<exclusion pattern="^http://stanfordcareers\.stanford\.edu/+(?!favicon\.ico|sites/)" />
		<!--
			Personal dirs 404
					-->
		<exclusion pattern="^http://(?:www-cs-students|xenon)\.stanford\.edu/+~" />

        <!-- Exclusion for Flashproxy: https://trac.torproject.org/projects/tor/wiki/FlashProxyFAQ -->
        <exclusion pattern="^http://crypto\.stanford\.edu/flashproxy/embed\.html" />

	<!--securecookie host="^(\.cs|\.engineering)?\.stanford\.edu$" name=".+" /-->
	<!--
		Not secured by server:
					-->
	<!--securecookie host="^\.stanford\.edu$" name="^(COOKIE_DEVICE_CLASS|SS_MID|pgn_new_browser|pgn_user2)$" /-->
	<!--securecookie host="^(alumni|alumni-gsb|givinghistory|honorrolls|makeagift|makeapledge|makeapledgepayment|pgnet)?\.stanford\.edu$" name="^TS[\da-f]{8}$" /-->
	<!--securecookie host="^doresearch\.stanford\.edu$" name="^(SimpleSAMLSessionID|simplesamlphp_auth_returnto)$" /-->
	<!--securecookie host="^(\.answers|\.bewell|\.bgm|\.engineering|\.facultyaffairs|\.facultyaffairs-humsci|\.hsdo|\.law|\.lbre|\.lib|\.maps|\.ohsx|\.porterdrive|\.stanfordcareers)?\.stanford\.edu$" name="^SESS[\da-f]{32}$" /-->
	<!--securecookie host="^epgy\.stanford\.edu$" name="^[\da-f]{32}$" /-->
	<!--securecookie host="^(hannahousetours|anderson)\.stanford\.edu$" name="^PHPSESSID$" /-->
	<!--securecookie host="^(explorecourses|lane|profiles|scpd)\.stanford\.edu$" name="^JSESSIONID$" /-->
	<!--securecookie host="^blogs\.law\.stanford\.edu$" name="^bid$" /-->
	<!--securecookie host="^library\.stanford\.edu$" name="^BIGipServer~SULAIR~libweb_https$" /-->
	<!--securecookie host="^mvideos\.stanford\.edu$" name="^(ASP\.NET_SessionId|\.ASPXAUTH)$" /-->

	<securecookie host="^(?:adminguide|alumni|\.answers|ehsappprd1|hannahousetours|\.itservices|\.law|\.lbre|maven|openflow|parents|pgnet|\.siepr|(?:\.news|www6)\.slac\|stanfordwho|weblogin|webauth1).stanford\.edu$" name=".+" />


	<rule from="^https?://(?:www\.)?(slac\.)?stanford\.edu/"
		to="https://www.$1stanford.edu/" />

	<rule from="^http://(accessories|adminguide|ai|alumni|annualreport|answers|assu-web|ccrma|crowd|crypto|ctr|cyberlaw|ehsappprd1|engineering|events|founders|hannahousetours|itservices|itunes|janestanford|(?:blogs\.|cch\.|www\.)?law|lbre|lists|mailman|maven|med|news|npl|oia|openflow|osep|parents|parentsweekend|pgnet|publicaffairs|refunds|remedyweb|siepr|(?:bbr-wiki|news|oraweb|plato|webauth1|www[26]|www-conf|www-group|www-public)\.slac|stanford(?:careers|events|who)|studentaffairs|ucomm|visit|waivers|web|weblogin|xenon)\.stanford\.edu/"
		to="https://$1.stanford.edu/" />

	<rule from="^http://(?:www\.)?cs\.stanford\.edu/"
		to="https://cs.stanford.edu/" />

	<rule from="^https?://askjane\.stanford\.edu/(?:.*)"
		to="https://studentaffairs.stanford.edu/askjane" />

	<rule from="^https?://(?:www-)?ee\.stanford\.edu/"
		to="https://ee.stanford.edu/" />

	<rule from="^http://fingate\.stanford\.edu/"
		to="https://www.stanford.edu/group/fms/fingate/" />

	<rule from="^http://search\.stanford\.edu/"
		to="https://www.stanford.edu/search/" />

	<rule from="^http://soe\.stanford\.edu/+(?=\?.*)?$"
		to="https://engineering.stanford.edu/" />

	<rule from="^http://studentservicescenter\.stanford\.edu/"
		to="https://www.stanford.edu/group/studentservicescenter/" />

	<rule from="^http://www-cs-students\.stanford\.edu/"
		to="https://xenon.stanford.edu/" />

</ruleset>
